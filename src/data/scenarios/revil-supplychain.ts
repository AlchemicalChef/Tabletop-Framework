import type { LibraryEntry } from '../library'

export const revilSupplyChainScenario: LibraryEntry = {
  id: 'revil-supplychain-001',
  title: 'REvil Supply Chain Ransomware Attack',
  category: 'supply_chain',
  difficulty: 'advanced',
  duration: 180,
  description: 'A ransomware group exploits a zero-day vulnerability in your MSP management software to deploy ransomware across your environment and your customers. Based on the 2021 Kaseya VSA attack affecting 1,500+ organizations. This exercise tests supply chain security, multi-stakeholder crisis management, and ransomware response.',
  tags: ['supply-chain', 'ransomware', 'revil', 'msp', 'zero-day', 'kaseya', 'vendor-risk'],
  moduleCount: 3,
  injectCount: 13,
  questionCount: 12,
  scenario: {
    id: 'revil-supplychain-001',
    title: 'REvil Supply Chain Ransomware Attack',
    description: 'A ransomware group exploits a zero-day vulnerability in your MSP management software to deploy ransomware across your environment and your customers. Based on the 2021 Kaseya VSA attack affecting 1,500+ organizations. This exercise tests supply chain security, multi-stakeholder crisis management, and ransomware response.',
    version: '1.0.0',
    author: 'Keith',
    createdAt: '2024-07-01T00:00:00Z',
    updatedAt: '2024-07-01T00:00:00Z',
    threatCategory: 'supply_chain',
    difficulty: 'advanced',
    estimatedDuration: 180,
    targetAudience: ['IT Operations', 'Vendor Management', 'Executive Leadership', 'Incident Response', 'Customer Success'],
    objectives: [
      'Evaluate vendor security assessment and monitoring practices',
      'Practice coordinated response across multiple affected organizations',
      'Test ransomware response when attack vector is trusted software',
      'Exercise stakeholder communication during supply chain incident',
      'Identify gaps in software supply chain risk management'
    ],
    facilitatorGuide: {
      id: 'fg-revil-supplychain-001',
      createdAt: '2024-07-01T00:00:00Z',
      updatedAt: '2024-07-01T00:00:00Z',
      title: 'Facilitator Guide - REvil Supply Chain Scenario',
      type: 'facilitator_guide',
      format: 'markdown',
      content: 'This scenario is based on the REvil/Sodinokibi attack on Kaseya VSA in July 2021. Key elements: (1) Zero-day exploitation of MSP software, (2) Trusted update mechanism abused, (3) PowerShell disables security tools, (4) DLL side-loading for execution, (5) Cascading impact to MSP customers. The attack affected 60 MSPs and up to 1,500 downstream businesses. Initial ransom demand was $70M. Emphasize the unique challenges of supply chain attacks where your vendor is the initial victim.'
    },
    additionalMaterials: [],
    settings: {
      allowParticipantSkip: false,
      requireAllResponses: true,
      showInjectTimestamps: true,
      enableAnonymousResponses: false
    },
    modules: [
      {
        id: 'rv-mod-1-detection',
        createdAt: '2024-07-01T00:00:00Z',
        updatedAt: '2024-07-01T00:00:00Z',
        order: 1,
        title: 'Supply Chain Compromise Detection',
        description: 'Unusual activity is detected originating from trusted management software, revealing a supply chain attack in progress.',
        phase: 'detection',
        suggestedDuration: 60,
        facilitatorNotes: 'The key challenge is that the attack comes from trusted software. Detection is often delayed because security tools are configured to trust the management agent.',
        injects: [
          {
            id: 'rv-inj-1-1',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 1,
            title: 'Vendor Emergency Notification',
            content: 'VENDOR COMMUNICATION - URGENT\nFrom: SecureManage Solutions (Your RMM Vendor)\nSubject: CRITICAL - Immediate Action Required\n\nDear Customer,\n\nWe are investigating a potential security incident affecting our SecureManage VSA product. As a precautionary measure:\n\n**IMMEDIATELY SHUT DOWN YOUR ON-PREMISE VSA SERVER**\n\nDo NOT wait for further instructions. Power off now.\n\nWe have detected potential compromise of our software update mechanism. Until we complete our investigation, all VSA servers should be offline.\n\nWe will provide updates every 2 hours. Do NOT power VSA servers back on until we confirm it is safe.\n\nThis is not a drill. Immediate action required.\n\nSecureManage Security Team',
            type: 'escalation',
            severity: 'critical',
            triggerTime: 0,
            source: 'RMM Vendor',
            facilitatorNotes: 'This mirrors Kaseya\'s urgent notification. The vendor has detected the issue but you may already be compromised.',
            expectedActions: ['Immediately shut down VSA servers', 'Assess if any deployments occurred', 'Check for ransomware indicators', 'Alert IR team'],
            attachments: [],
            relatedQuestionIds: ['rv-q-1-1']
          },
          {
            id: 'rv-inj-1-2',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 2,
            title: 'EDR Alert - Defender Disabled',
            content: 'EDR ALERT CLUSTER - CRITICAL\nSource: CrowdStrike/SentinelOne/Defender ATP\n\nMultiple endpoints reporting Windows Defender tampering:\n\nAffected Hosts: 127 endpoints (and growing)\n\nActivity Detected:\n- PowerShell executed with high privileges\n- Windows Defender real-time protection disabled\n- Multiple security features turned off:\n  - Cloud-delivered protection: DISABLED\n  - Network protection: DISABLED\n  - Controlled folder access: DISABLED\n\nParent Process: SecureManageAgent.exe (SIGNED, TRUSTED)\nCommand Line: powershell.exe -ExecutionPolicy Bypass -File C:\\kworking\\agent.ps1\n\nNote: Activity originates from your trusted RMM agent. Agent is in exclusion list.',
            type: 'technical',
            severity: 'critical',
            triggerTime: 5,
            source: 'Endpoint Detection & Response',
            facilitatorNotes: 'The RMM agent is in EDR exclusions (per vendor requirements), so the malicious activity appears as trusted behavior.',
            expectedActions: ['Remove RMM from exclusions immediately', 'Isolate affected endpoints', 'Stop RMM agent service everywhere', 'Collect forensic artifacts'],
            attachments: [],
            relatedQuestionIds: ['rv-q-1-2']
          },
          {
            id: 'rv-inj-1-3',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 3,
            title: 'Ransomware Encryption Begins',
            content: 'CRITICAL ALERT - RANSOMWARE DETECTED\nMultiple Locations Affected Simultaneously\n\nRansomware encryption detected across environment:\n\nAffected Systems (growing):\n- 50+ workstations encrypted\n- 12 servers encrypted\n- File shares showing .revil extension\n- Domain controllers currently UNAFFECTED\n\nRansomware Identified: REvil/Sodinokibi variant\nEncryption: AES-256 + RSA-4096\n\nRansom Note (readme.txt):\n"All your files have been encrypted!\nTo decrypt, follow instructions on our TOR site.\nDO NOT modify encrypted files.\nDO NOT use third-party decryption tools.\nYour unique ID: [REDACTED]\nPayment site: [.onion address]"\n\nNote: All affected systems had SecureManage agent installed.',
            type: 'escalation',
            severity: 'critical',
            triggerTime: 12,
            source: 'IT Operations / Multiple Users',
            facilitatorNotes: 'REvil ransomware is now active. The common factor is the RMM agent. Domain controllers being unaffected is good news.',
            expectedActions: ['Isolate all affected systems', 'Disable network shares', 'Verify backup integrity', 'Consider network-wide RMM agent removal'],
            attachments: [],
            relatedQuestionIds: ['rv-q-1-3']
          },
          {
            id: 'rv-inj-1-4',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 4,
            title: 'Customer Calls - Their Systems Down Too',
            content: 'CUSTOMER ESCALATION - URGENT\nMultiple Priority 1 incidents logged:\n\nCustomer: Midwest Regional Hospital\n"Our entire EHR system is down. We\'re seeing ransomware. Was there an update from your platform last night?"\n\nCustomer: First Community Bank\n"50+ branch workstations encrypted. All had your management agent. What\'s going on?"\n\nCustomer: Jefferson School District\n"We can\'t access any systems. Summer school registration is today. Parents are already lined up."\n\nCustomer: Regional Grocery Chain (15 stores)\n"Point of sale systems are down across all locations. We can\'t process transactions."\n\nNote: You provide managed IT services to these customers using the compromised RMM platform. Their systems connect to your VSA server.',
            type: 'escalation',
            severity: 'critical',
            triggerTime: 20,
            source: 'Customer Success / Support',
            facilitatorNotes: 'If you\'re an MSP, your customers are also affected. This is the cascading impact that made Kaseya so devastating.',
            expectedActions: ['Brief customers on situation', 'Help customers isolate systems', 'Coordinate joint response', 'Document affected customer systems'],
            attachments: [],
            relatedQuestionIds: ['rv-q-1-4']
          }
        ],
        discussionQuestions: [
          {
            id: 'rv-q-1-1',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 1,
            question: 'Your software vendor sends an emergency "shut down immediately" message. How do you verify this is legitimate and not a social engineering attack, while still acting quickly?',
            category: 'decision',
            responseType: 'text',
            guidanceNotes: 'Discuss verification procedures, pre-established emergency contacts, and balancing speed with verification.',
            expectedThemes: ['Emergency verification', 'Vendor communication channels', 'Speed vs. verification', 'Pre-established procedures']
          },
          {
            id: 'rv-q-1-2',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 2,
            question: 'Your EDR detected Defender being disabled, but the parent process is your trusted RMM agent which is in the exclusion list. How should you handle security tool exclusions for management software?',
            category: 'technical',
            responseType: 'text',
            guidanceNotes: 'Discuss the tension between vendor requirements for exclusions and security monitoring, and alternatives to broad exclusions.',
            expectedThemes: ['Exclusion management', 'Vendor requirements', 'Behavioral monitoring', 'Least privilege']
          },
          {
            id: 'rv-q-1-3',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 3,
            question: 'Ransomware is spreading through your environment via trusted management software. What is your immediate containment strategy when the attack vector is software you rely on for IT operations?',
            category: 'technical',
            responseType: 'text',
            guidanceNotes: 'Discuss alternative management methods, network isolation, and operating without normal IT tools.',
            expectedThemes: ['Alternative management', 'Network isolation', 'Operating manually', 'Containment priorities']
          },
          {
            id: 'rv-q-1-4',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 4,
            question: 'Your customers are calling because their systems are encrypted too - they were managed through your compromised platform. What is your obligation to help them, and how do you coordinate response across multiple organizations?',
            category: 'coordination',
            responseType: 'text',
            guidanceNotes: 'Discuss MSP responsibilities, customer communication, joint response coordination, and liability considerations.',
            expectedThemes: ['MSP responsibilities', 'Customer communication', 'Coordinated response', 'Liability considerations']
          }
        ]
      },
      {
        id: 'rv-mod-2-containment',
        createdAt: '2024-07-01T00:00:00Z',
        updatedAt: '2024-07-01T00:00:00Z',
        order: 2,
        title: 'Multi-Tenant Crisis Management',
        description: 'With ransomware affecting both your organization and your customers, crisis management becomes a multi-stakeholder coordination challenge.',
        phase: 'containment',
        suggestedDuration: 60,
        facilitatorNotes: 'This module focuses on the unique challenges of supply chain incidents: coordinating across organizations, managing vendor relationship, and handling cascading impacts.',
        injects: [
          {
            id: 'rv-inj-2-1',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 1,
            title: 'Vendor Confirms Zero-Day Exploit',
            content: 'VENDOR UPDATE - TECHNICAL DETAILS\nFrom: SecureManage Security Team\n\nOur investigation has confirmed:\n\nATTACK VECTOR:\n- Zero-day vulnerability in VSA server authentication (CVE pending)\n- SQL injection allowing authentication bypass\n- Arbitrary command execution on VSA server\n- Malicious "hotfix" pushed through legitimate update mechanism\n\nPAYLOAD DETAILS:\n- PowerShell script disables Windows Defender\n- Drops agent.exe (legitimate Microsoft signed binary)\n- Sideloads malicious mpsvc.dll (REvil ransomware)\n- Uses legitimate binary to bypass application controls\n\nAFFECTED VERSIONS: VSA 9.5.x on-premise (all builds)\nNOT AFFECTED: SaaS customers, VSA 10.x\n\nPATCH AVAILABILITY: Under development. ETA 48-72 hours.\n\nREMEDIATION: Keep VSA offline. Do not attempt to restore from backup until patch is available.',
            type: 'information',
            severity: 'critical',
            triggerTime: 0,
            source: 'RMM Vendor',
            facilitatorNotes: 'The vendor has confirmed the attack method. The 48-72 hour patch timeline is challenging. DLL sideloading is a sophisticated technique.',
            expectedActions: ['Document IOCs for threat hunting', 'Assess exposure scope', 'Plan for extended outage', 'Evaluate alternative management tools'],
            attachments: [],
            relatedQuestionIds: ['rv-q-2-1']
          },
          {
            id: 'rv-inj-2-2',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 2,
            title: 'FBI Cyber Division Contact',
            content: 'FEDERAL LAW ENFORCEMENT CONTACT\n\nThe FBI Cyber Division has reached out to your organization:\n\n"We are tracking the ongoing REvil ransomware campaign affecting SecureManage VSA customers nationwide. We would like to coordinate with your organization.\n\nWhat we need:\n- IOCs from your environment\n- Ransom notes and payment demands\n- Timeline of events\n- List of affected downstream customers (if MSP)\n\nWhat we can provide:\n- Threat intelligence on REvil actors\n- Coordination with other affected organizations\n- Potential access to decryption resources\n- Guidance on ransom payment implications\n\nNote: Payment to REvil may violate OFAC sanctions. We recommend consultation before any payment decision.\n\nAttorney General may issue public statement today linking attack to Russia-based criminal group."',
            type: 'information',
            severity: 'high',
            triggerTime: 15,
            source: 'FBI Cyber Division',
            facilitatorNotes: 'Federal involvement changes the dynamics. The OFAC sanctions warning is real - REvil has been sanctioned. FBI coordination was key in the actual Kaseya response.',
            expectedActions: ['Engage legal counsel', 'Coordinate with FBI', 'Preserve evidence', 'Document for potential prosecution'],
            attachments: [],
            relatedQuestionIds: ['rv-q-2-2']
          },
          {
            id: 'rv-inj-2-3',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 3,
            title: 'Ransom Demand Received',
            content: 'RANSOM NEGOTIATION\nSource: REvil TOR Portal\n\nYour organization\'s ransom portal shows:\n\nOrganization Impact:\n- 127 systems encrypted\n- Estimated data: 4.2 TB\n\nDemand:\n- Initial: $5,000,000 USD in Bitcoin\n- Deadline: 72 hours\n- After deadline: Price doubles\n- After 7 days: Data published\n\nREvil Message:\n"We know you are an MSP. We have your customers too. Want a bulk deal? Contact us.\n\nWe offer:\n- Decryption tools\n- Deletion of exfiltrated data\n- Security audit report (how we got in)\n- Promise not to attack again for 2 years"\n\nNote: REvil also offered Kaseya a "universal decryptor" for $70M to decrypt all victims.',
            type: 'decision_point',
            severity: 'critical',
            triggerTime: 30,
            source: 'Threat Actor Communication',
            facilitatorNotes: 'The "bulk deal" offer is unique to MSP attacks. REvil actually did offer universal decryptors. Discuss the ethics and practicality of payment.',
            expectedActions: ['Do not respond without legal counsel', 'Assess backup viability', 'Calculate business impact', 'Coordinate with insurance'],
            attachments: [],
            relatedQuestionIds: ['rv-q-2-3']
          },
          {
            id: 'rv-inj-2-4',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 4,
            title: 'Hospital Customer - Patient Safety',
            content: 'CRITICAL CUSTOMER ESCALATION\nFrom: Midwest Regional Hospital (Your Customer)\n\nEmergency:\n\nOur EHR system remains encrypted. Impact:\n\n- Cannot access patient medical records\n- Medication administration is manual (paper-based)\n- Lab results not accessible electronically\n- Imaging systems offline\n- Emergency department on diversion\n\nWe have:\n- 3 patients requiring immediate medication information\n- 1 surgical case postponed (cannot access pre-op records)\n- 12-hour paper-based operations limit before safety risk increases\n\nHospital CEO demands:\n"We need systems restored in 24 hours or we may need to transfer patients. If someone is harmed because of this attack that came through YOUR software, the liability discussion will be very different."\n\nState Health Department has been notified of potential patient safety incident.',
            type: 'escalation',
            severity: 'critical',
            triggerTime: 45,
            source: 'Customer - Healthcare',
            facilitatorNotes: 'Patient safety adds life-or-death urgency. This is not hypothetical - the Kaseya attack affected healthcare organizations. Discuss prioritization.',
            expectedActions: ['Prioritize healthcare customer recovery', 'Explore isolated restoration options', 'Coordinate with hospital IT', 'Document patient safety timeline'],
            attachments: [],
            relatedQuestionIds: ['rv-q-2-4']
          },
          {
            id: 'rv-inj-2-5',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 5,
            title: 'Media Coverage Intensifies',
            content: 'MEDIA MONITORING ALERT\n\nMajor news coverage of the attack:\n\nCNN: "Massive ransomware attack hits hundreds of US businesses over July 4th weekend"\n\nWSJ: "Russia-Linked Hackers Target IT Management Firm, Causing Widespread Damage"\n\nLocal News: "Regional hospital diverts patients after cyber attack"\n\nTweets from security researchers:\n- "Confirmed: REvil hit [Your Company] through SecureManage VSA"\n- "List of affected organizations growing: hospitals, banks, schools"\n- "This is what supply chain attacks look like"\n\nPresident\'s Statement: "We are taking steps to address this latest ransomware attack. I have directed the full resources of the government to assist in the response."\n\nReporter outside your office: "Can you confirm how many of your customers were affected?"',
            type: 'media',
            severity: 'high',
            triggerTime: 55,
            source: 'Media Relations',
            facilitatorNotes: 'The Kaseya attack received presidential attention. The national security implications of supply chain attacks are significant.',
            expectedActions: ['Prepare media statement', 'Coordinate messaging with vendor', 'Brief executive team', 'Do not speculate on details'],
            attachments: [],
            relatedQuestionIds: ['rv-q-2-5']
          }
        ],
        discussionQuestions: [
          {
            id: 'rv-q-2-1',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 1,
            question: 'Your vendor confirms a zero-day vulnerability in their software was exploited. The patch won\'t be ready for 48-72 hours. How do you operate your IT environment without your primary management tool?',
            category: 'technical',
            responseType: 'text',
            guidanceNotes: 'Discuss contingency planning for tool failures, alternative management approaches, and manual processes.',
            expectedThemes: ['Contingency planning', 'Alternative tools', 'Manual operations', 'IT resilience']
          },
          {
            id: 'rv-q-2-2',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 2,
            question: 'The FBI contacts you and warns that paying the ransom may violate OFAC sanctions. How does potential legal liability for sanctions violations factor into your payment decision?',
            category: 'decision',
            responseType: 'text',
            guidanceNotes: 'Discuss OFAC implications, legal counsel engagement, Treasury guidance, and risk assessment.',
            expectedThemes: ['OFAC sanctions', 'Legal liability', 'Risk assessment', 'Government coordination']
          },
          {
            id: 'rv-q-2-3',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 3,
            question: 'The attackers offer a "bulk deal" to decrypt both your systems and your customers\' systems. Would you consider coordinating payment across affected organizations? What are the ethical and practical implications?',
            category: 'decision',
            responseType: 'text',
            guidanceNotes: 'Discuss coordinated response, shared costs, ethical considerations, and precedent setting.',
            expectedThemes: ['Coordinated payment', 'Shared liability', 'Ethical considerations', 'Negotiation strategy']
          },
          {
            id: 'rv-q-2-4',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 4,
            question: 'A hospital customer says patient safety is at risk and threatens to hold you liable if patients are harmed. How do you prioritize recovery efforts, and what are your legal obligations?',
            category: 'decision',
            responseType: 'text',
            guidanceNotes: 'Discuss prioritization criteria, liability considerations, contractual obligations, and ethical duties.',
            expectedThemes: ['Recovery prioritization', 'Life safety', 'Liability management', 'Ethical obligations']
          }
        ]
      },
      {
        id: 'rv-mod-3-recovery',
        createdAt: '2024-07-01T00:00:00Z',
        updatedAt: '2024-07-01T00:00:00Z',
        order: 3,
        title: 'Recovery & Vendor Accountability',
        description: 'As recovery begins, the organization must navigate restoration decisions, vendor accountability, and long-term supply chain security improvements.',
        phase: 'recovery',
        suggestedDuration: 60,
        facilitatorNotes: 'Focus on the recovery decisions and the aftermath of supply chain attacks. Discuss vendor accountability, contract implications, and security improvements.',
        injects: [
          {
            id: 'rv-inj-3-1',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 1,
            title: 'Backup Assessment Complete',
            content: 'BACKUP AND RECOVERY ASSESSMENT\nFrom: IT Operations\n\nBackup Status Analysis:\n\nCORPORATE SYSTEMS:\n- Domain controllers: Clean backup available (24 hours old)\n- File servers: Backup available but some encrypted (backup agent used RMM)\n- Email: O365, unaffected\n- ERP: Backup verified clean, 48 hours data loss\n\nCUSTOMER ENVIRONMENTS:\n- 40% have clean backups (offline/air-gapped)\n- 35% have partial backups (some encrypted)\n- 25% have no viable backups or backups are encrypted\n\nRecovery Time Estimates:\n- Full internal recovery: 5-7 days\n- Customer recovery (where possible): 7-14 days\n- Total effort: 2,000+ person-hours estimated\n\nChallenge: Some customers with encrypted backups are demanding we pay their ransom.',
            type: 'information',
            severity: 'high',
            triggerTime: 0,
            source: 'IT Operations',
            facilitatorNotes: 'The backup situation varies significantly. Air-gapped backups worked. RMM-managed backups were often encrypted.',
            expectedActions: ['Prioritize recovery by customer criticality', 'Begin clean system rebuilds', 'Address customers without backups', 'Document lessons learned'],
            attachments: [],
            relatedQuestionIds: ['rv-q-3-1']
          },
          {
            id: 'rv-inj-3-2',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 2,
            title: 'Universal Decryptor Obtained',
            content: 'BREAKING DEVELOPMENT\n\nA universal decryptor for this REvil campaign has been obtained:\n\nSource: Through FBI coordination with international partners, a universal decryption key has been secured. This can decrypt ALL systems affected by this specific REvil campaign.\n\nAvailability: Being distributed through:\n- FBI directly to US victims\n- SecureManage to their customers\n- CISA Ransomware Response Team\n\nVerification: Decryptor has been tested and confirmed working.\n\nImportant Notes:\n- No ransom was paid for this key\n- Key was obtained through "law enforcement action"\n- Decryptor will be available within 24 hours\n- Some file corruption may still occur due to encryption process\n\nNote: This mirrors how Kaseya obtained a universal decryptor ~3 weeks after the attack.',
            type: 'information',
            severity: 'high',
            triggerTime: 20,
            source: 'FBI / CISA',
            facilitatorNotes: 'This mirrors the real Kaseya outcome - a universal decryptor was obtained without ransom payment. Discuss the value of law enforcement coordination.',
            expectedActions: ['Obtain decryptor through official channels', 'Test before broad deployment', 'Continue backup-based recovery', 'Plan for data validation'],
            attachments: [],
            relatedQuestionIds: ['rv-q-3-2']
          },
          {
            id: 'rv-inj-3-3',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 3,
            title: 'Customer Threatens Lawsuit',
            content: 'LEGAL NOTIFICATION\nFrom: Outside Counsel representing Midwest Regional Hospital\n\nRE: Notice of Intent to File Litigation\n\nDear [Company]:\n\nOur client, Midwest Regional Hospital, hereby provides notice of intent to file litigation against your organization for damages arising from the ransomware attack of [date].\n\nAllegations:\n- Negligent security practices by your managed services organization\n- Failure to properly secure systems used to manage client infrastructure\n- Breach of contract (SLA guarantees of 99.9% uptime)\n- Failure to warn of known vulnerabilities\n- Damages for patient care disruption\n\nOur client suffered:\n- 5 days of EHR downtime\n- Emergency room diversion for 2 days\n- Estimated financial impact: $4.2M\n- Reputational damage with patients and community\n\nWe demand preservation of all relevant documents and communications.',
            type: 'regulatory',
            severity: 'high',
            triggerTime: 40,
            source: 'Legal',
            facilitatorNotes: 'Litigation from affected customers is a real consequence. Discuss contractual protections, insurance, and liability considerations.',
            expectedActions: ['Engage legal counsel', 'Implement litigation hold', 'Review contract terms', 'Notify insurance carrier'],
            attachments: [],
            relatedQuestionIds: ['rv-q-3-3']
          },
          {
            id: 'rv-inj-3-4',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 4,
            title: 'Vendor Offers Remediation',
            content: 'VENDOR COMMUNICATION\nFrom: SecureManage CEO\n\nDear Valued Customer,\n\nWe take full responsibility for the security incident affecting your organization. We are committed to supporting your recovery and have implemented the following:\n\nIMMEDIATE:\n- Free access to incident response resources\n- 6 months of credit monitoring for affected individuals\n- Extended support hours for recovery assistance\n\nLONG-TERM:\n- 12 months of free service\n- Complete security architecture review\n- SOC 2 Type II audit by independent firm\n- Bug bounty program launch\n- $10M fund for customer recovery costs\n\nWe are also committing to:\n- Publishing full technical details of the vulnerability\n- Working with CISA on best practices for MSP security\n- Congressional testimony on supply chain security\n\nWe understand trust must be rebuilt through actions, not words.',
            type: 'information',
            severity: 'medium',
            triggerTime: 55,
            source: 'RMM Vendor',
            facilitatorNotes: 'Vendor remediation offers are important for continuing the relationship. Discuss whether these commitments are sufficient.',
            expectedActions: ['Evaluate vendor commitments', 'Assess long-term vendor relationship', 'Review security requirements', 'Consider alternatives'],
            attachments: [],
            relatedQuestionIds: ['rv-q-3-4']
          }
        ],
        discussionQuestions: [
          {
            id: 'rv-q-3-1',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 1,
            question: '25% of your customers have no viable backups. Some are demanding you pay their ransom. What is your obligation to customers who didn\'t follow backup best practices, and who should pay?',
            category: 'decision',
            responseType: 'text',
            guidanceNotes: 'Discuss customer responsibility, contractual obligations, business relationships, and shared accountability.',
            expectedThemes: ['Customer responsibility', 'Contractual obligations', 'Business relationships', 'Shared accountability']
          },
          {
            id: 'rv-q-3-2',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 2,
            question: 'A universal decryptor was obtained through law enforcement without paying ransom. What are the lessons about law enforcement coordination, and would you have made different decisions if you knew this was possible?',
            category: 'lessons_learned',
            responseType: 'text',
            guidanceNotes: 'Discuss law enforcement value, patience in crisis, alternative resolution paths, and communication with authorities.',
            expectedThemes: ['Law enforcement value', 'Crisis patience', 'Alternative resolutions', 'Government coordination']
          },
          {
            id: 'rv-q-3-3',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 3,
            question: 'A customer is threatening to sue for damages caused by the attack that came through your managed services. How do your contracts address liability for security incidents, and what should they include?',
            category: 'policy',
            responseType: 'text',
            guidanceNotes: 'Discuss limitation of liability, cyber insurance requirements, indemnification, and contract best practices.',
            expectedThemes: ['Contract terms', 'Liability limitations', 'Insurance requirements', 'Legal protections']
          },
          {
            id: 'rv-q-3-4',
            createdAt: '2024-07-01T00:00:00Z',
            updatedAt: '2024-07-01T00:00:00Z',
            order: 4,
            question: 'Your RMM vendor is offering 12 months free service and a $10M recovery fund. Should you continue using them, switch vendors, or bring the capability in-house? What factors drive this decision?',
            category: 'lessons_learned',
            responseType: 'text',
            guidanceNotes: 'Discuss vendor evaluation, switching costs, security requirements, and long-term strategy.',
            expectedThemes: ['Vendor evaluation', 'Switching costs', 'Security requirements', 'Build vs. buy']
          }
        ]
      }
    ],
    tags: ['supply-chain', 'ransomware', 'revil', 'sodinokibi', 'msp', 'zero-day', 'kaseya', 'vendor-risk', 'fbi', 'cisa']
  }
}
